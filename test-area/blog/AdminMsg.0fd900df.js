function e(e){return e&&e.__esModule?e.default:e}function t(e,t,a,s){Object.defineProperty(e,t,{get:a,set:s,enumerable:!0,configurable:!0})}var a=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire35b1;a.register("5uSfZ",(function(s,n){var l;l=s.exports,Object.defineProperty(l,"__esModule",{value:!0,configurable:!0}),t(s.exports,"default",(function(){return u}),(function(e){return u=e}));var i=a("fcWWv"),r=a("kVWnA"),c=a("e0rqH"),m=a("stS02"),o=a("g5eIn"),d=a("7gcRj"),g=a("3Qkmj");var u=()=>{const{$:t,Fetch:a,getReducer:s,rwdStatus:n}=(0,c.useContext)(m.NewContext),{authInfo:l}=s((e=>(0,i.default)({},e.AdminLoginReducer))),[{msgData:u,renderMsgData:N,toggleModalStatus:E,toggleDeleteModalStatus:v,currentAction:f,valGroups:p,useDisabled:D,paginationObj:h},b]=(0,c.useState)({msgData:[],renderMsgData:[],toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},currentAction:"",useDisabled:!1,paginationObj:{}}),[k,C]=(0,c.useState)(!1),y={hasPrev:h.hasPrev,hasNext:h.hasNext,currentPage:h.currentPage,pageTotal:h.pageTotal,pageSize:h.pageSize,partPage:h.partPage,postNext:e=>{const{pages:t,partPage:a,pageSize:s}=e,{pageObj:n,renderItem:l}=o.default.createParts(u,t,a,s);b((e=>(0,r.default)((0,i.default)({},e),{renderMsgData:l,paginationObj:n})))}},P=e=>{const[t]=e.split(" ");return t},L=async()=>{C(!0),await a.get("/back_view_all",{token:l.token}).then((({data:e})=>{a.get("/back_msg_l_all",{token:l.token}).then((a=>{const s=t.maps(a.data,(a=>{const s=t.filter(e,(({uuid:e})=>e===a.articleID));return s.length>0?(0,r.default)((0,i.default)({},a),{articleTitle:s[0].articleTitle}):a})),{pageObj:n,renderItem:l}=o.default.createParts(s,1,10,10);b((e=>(0,r.default)((0,i.default)({},e),{msgData:s,renderMsgData:l,paginationObj:n}))),C(!1)})).catch((()=>alert("error")))})).catch((()=>alert("error")))},M=(e,t)=>{b("DELETE"===e?a=>(0,r.default)((0,i.default)({},a),{currentAction:e,valGroups:t,toggleDeleteModalStatus:!0}):a=>(0,r.default)((0,i.default)({},a),{currentAction:e,valGroups:t,toggleModalStatus:!0,useDisabled:"READ"===e}))},S=e=>{const a=JSON.parse(JSON.stringify(p)),s=t.findIndexOfObj(a.resContentList,(({resMsgID:t})=>t===e));a.resContentList=a.resContentList.remove(s),b((e=>(0,r.default)((0,i.default)({},e),{valGroups:a})))},T=(e,s)=>{let n=!1;(0,{[e]:async()=>{if("confirm"===s&&"READ"!==e){const e=t.formatDateTime({formatDate:new Date,formatType:"yyyy-MM-dd HH:mm:ss"}),s=JSON.parse(JSON.stringify(p));s.modifyDate=e,C(!0),await a.post("/update_msg_l",{token:l.token,data:s}),n=!0,C(!1)}},DELETE:async()=>{if("confirm"===s){const{mud:e}=p;C(!0),await a.post("/delete_msg_l",{token:l.token,data:{mud:e}}),L(),n=!0,C(!1)}}}[e])().finally((()=>{b((e=>(0,r.default)((0,i.default)({},e),{toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},useDisabled:!1}))),n&&L()}))};return(0,c.useEffect)((()=>{l.token&&L()}),[l]),e(c).createElement(g.Container,null,e(c).createElement("div",{className:"msg-layout"},n?null:e(c).createElement("div",{className:"msg-list-header"},["留言者","留言內容","留言文章","留言 / 修改日期","操作項"].map(((t,a)=>e(c).createElement("div",{key:a},t)))),e(c).createElement("div",{className:"msg-list"},0===N.length?e(c).createElement("div",{className:"no-data"},"-- 無留言 --"):N.map(((t,a)=>n?e(c).createElement("div",{key:a,className:"msg-list-item"},e(c).createElement("div",{className:"top"},e(c).createElement("div",{className:"left"},e(c).createElement("div",null,"留言者"),e(c).createElement("div",null,"留言內容"),e(c).createElement("div",null,"留言文章"),e(c).createElement("div",null,"留言 / 修改日期")),e(c).createElement("div",{className:"right"},e(c).createElement("div",null,t.msgNickName),e(c).createElement("div",null,t.msgContent),e(c).createElement("div",null,t.articleTitle),e(c).createElement("div",null,P(t.createDate)," / ",P(t.modifyDate)))),e(c).createElement("div",{className:"bottom"},e(c).createElement("div",{className:"btn-group"},e(c).createElement("div",{onClick:M.bind(void 0,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},e(c).createElement("i",{className:"fas fa-eye"})),e(c).createElement("div",{onClick:M.bind(void 0,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},e(c).createElement("i",{className:"fas fa-pencil"})),e(c).createElement("div",{onClick:M.bind(void 0,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},e(c).createElement("i",{className:"fas fa-trash-alt"}))))):e(c).createElement("div",{key:a,className:"msg-list-item"},e(c).createElement("div",null,t.msgNickName),e(c).createElement("div",null,t.msgContent),e(c).createElement("div",null,t.articleTitle),e(c).createElement("div",null,P(t.createDate)," / ",P(t.modifyDate)),e(c).createElement("div",{className:"btn-group"},e(c).createElement("div",{onClick:M.bind(void 0,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},e(c).createElement("i",{className:"fas fa-eye"})),e(c).createElement("div",{onClick:M.bind(void 0,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},e(c).createElement("i",{className:"fas fa-pencil"})),e(c).createElement("div",{onClick:M.bind(void 0,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},e(c).createElement("i",{className:"fas fa-trash-alt"}))))))),e(c).createElement("div",{className:"msg-list-footer"},"總留言數 ",u.length," 則"),e(c).createElement(d.Pagination,y)),e(c).createElement(d.ActionModal,{acionModalTitle:`${{DELETE:"刪除",READ:"檢視",EDIT:"編輯"}[f]}留言`,toggleModalStatus:E,confirmEvent:T.bind(void 0,f,"confirm"),cancelEvent:D?void 0:T.bind(void 0,f,"cancel")},e(c).createElement("div",{className:"top"},e(c).createElement(d.CustomInput,{label:"留言者",bindVal:p.msgNickName,type:"text",disabled:!0,className:p.msgNickName?"lock":""}),e(c).createElement("div",{className:"text-area-outer"},e(c).createElement(d.CustomTextArea,{label:"留言內容",bindVal:p.msgContent,type:"text",disabled:!0,className:p.msgContent?"lock":""}))),e(c).createElement("div",{className:"bottom"},e(c).createElement("div",{className:"title"},"回覆留言"),e(c).createElement("div",{className:"res-msg-list-outer"},p.resContentList.length>0?e(c).createElement("div",{className:"res-msg-list"},p.resContentList.map(((t,a)=>e(c).createElement("div",{key:a,className:"res-msg-list-item-outer"},e(c).createElement("div",{className:"row g-0"},e(c).createElement("div",{className:D?"col-sm-12":"col-sm-11"},e(c).createElement("div",{className:"res-msg-list-item"},e(c).createElement("div",{className:"res-msg-title"}," ",e(c).createElement("div",null,t.resMsgNickName),e(c).createElement("div",{className:"right-group"},e(c).createElement("div",null,P(t.createDate)))),e(c).createElement("div",null,t.resMsgContent))),D?null:e(c).createElement("div",{className:"col-sm-1"},e(c).createElement("div",{onClick:S.bind(void 0,t.resMsgID),className:"delete-msg-btn"},e(c).createElement("i",{className:"fas fa-trash-alt"})))))))):e(c).createElement("div",{className:"no-data"},"-- 無回覆內容 --")))),e(c).createElement(d.ActionModal,{toggleModalStatus:v,confirmEvent:T.bind(void 0,f,"confirm"),cancelEvent:T.bind(void 0,f,"cancel")},e(c).createElement("div",{className:"action-modal-body"},e(c).createElement("div",{className:"delete-context"},"確定要刪除 ",p.msgNickName," 此人的留言嗎？"))),e(c).createElement(d.Loading,{loadingStatus:k}))}})),a.register("g5eIn",(function(e,s){t(e.exports,"default",(function(){return i}));var n=a("G2HKY");class l{static createParts(...e){let[t,a,s,n]=e;this.setting.totalLength=t.length,this.setting.partPage=s,this.setting.pageTotal=Math.ceil(this.setting.totalLength/this.setting.partPage),this.setting.pageSize=n,a=void 0===a?1:a,this.setting.currentPage=a,this.setting.hasPrev=this.setting.currentPage>1,this.setting.hasNext=this.setting.currentPage<this.setting.totalLength,this.setting.currentPage===this.setting.pageTotal&&(this.setting.hasNext=!1),this.setting.currentPage>this.setting.pageTotal&&(this.setting.currentPage=this.setting.pageTotal);const l=this.setting.currentPage*this.setting.partPage-this.setting.partPage+1,i=this.setting.currentPage*this.setting.partPage,r=t.map(((e,t)=>t+1>=l&&t+1<=i&&e)).filter((e=>!1!==e));return{pageObj:this.setting,renderItem:r}}}(0,n.default)(l,"setting",{totalLength:0,partPage:0,pageTotal:0,currentPage:1,hasPrev:!1,hasNext:!0,pageSize:0});var i=l}));