!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,a,n){Object.defineProperty(e,t,{get:a,set:n,enumerable:!0,configurable:!0})}var a=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire35b1;a.register("caVT7",(function(n,s){var l;l=n.exports,Object.defineProperty(l,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",(function(){return p}),(function(e){return p=e}));var r=a("8CHzG"),i=a("fto12"),c=a("75JRK"),m=a("e4tPT"),o=a("4Fae7"),u=a("bW9HB"),d=a("diPDO"),g=a("5OXzf"),f=a("e4nhi"),N=a("dR8pc"),E=a("7fGfG"),v=void 0,p=function(){var t,a=(0,d.useContext)(g.NewContext),n=a.$,s=a.Fetch,l=a.getReducer,p=a.rwdStatus,h=l((function(e){return(0,c.default)({},e.AdminLoginReducer)})).authInfo,D=(0,o.default)((0,d.useState)({msgData:[],renderMsgData:[],toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},currentAction:"",useDisabled:!1,paginationObj:{}}),2),b=D[0],C=b.msgData,k=b.renderMsgData,P=b.toggleModalStatus,y=b.toggleDeleteModalStatus,L=b.currentAction,T=b.valGroups,M=b.useDisabled,S=b.paginationObj,I=D[1],_=(0,o.default)((0,d.useState)(!1),2),x=_[0],O=_[1],w={hasPrev:S.hasPrev,hasNext:S.hasNext,currentPage:S.currentPage,pageTotal:S.pageTotal,pageSize:S.pageSize,partPage:S.partPage,postNext:function(e){var t=e.pages,a=e.partPage,n=e.pageSize,s=f.default.createParts(C,t,a,n),l=s.pageObj,r=s.renderItem;I((function(e){return(0,m.default)((0,c.default)({},e),{renderMsgData:r,paginationObj:l})}))}},A=function(e){return(0,o.default)(e.split(" "),1)[0]},j=(t=(0,r.default)((function(){return(0,u.__generator)(this,(function(e){switch(e.label){case 0:return O(!0),[4,s.get("/back_view_all",{token:h.token}).then((function(e){var t=e.data;s.get("/back_msg_l_all",{token:h.token}).then((function(e){var a=n.maps(e.data,(function(e){var a=n.filter(t,(function(t){return t.uuid===e.articleID}));return a.length>0?(0,m.default)((0,c.default)({},e),{articleTitle:a[0].articleTitle}):e})),s=f.default.createParts(a,1,10,10),l=s.pageObj,r=s.renderItem;I((function(e){return(0,m.default)((0,c.default)({},e),{msgData:a,renderMsgData:r,paginationObj:l})})),O(!1)})).catch((function(){return alert("error")}))})).catch((function(){return alert("error")}))];case 1:return e.sent(),[2]}}))})),function(){return t.apply(this,arguments)}),R=function(e,t){I("DELETE"===e?function(a){return(0,m.default)((0,c.default)({},a),{currentAction:e,valGroups:t,toggleDeleteModalStatus:!0})}:function(a){return(0,m.default)((0,c.default)({},a),{currentAction:e,valGroups:t,toggleModalStatus:!0,useDisabled:"READ"===e})})},G=function(e){var t=JSON.parse(JSON.stringify(T)),a=n.findIndexOfObj(t.resContentList,(function(t){return t.resMsgID===e}));t.resContentList=t.resContentList.remove(a),I((function(e){return(0,m.default)((0,c.default)({},e),{valGroups:t})}))},z=function(e,t){var a,l=!1;(0,(a={},(0,i.default)(a,e,(0,r.default)((function(){var a,r;return(0,u.__generator)(this,(function(i){switch(i.label){case 0:return"confirm"!==t||"READ"===e?[3,2]:(a=n.formatDateTime({formatDate:new Date,formatType:"yyyy-MM-dd HH:mm:ss"}),(r=JSON.parse(JSON.stringify(T))).modifyDate=a,O(!0),[4,s.post("/update_msg_l",{token:h.token,data:r})]);case 1:i.sent(),l=!0,O(!1),i.label=2;case 2:return[2]}}))}))),(0,i.default)(a,"DELETE",(0,r.default)((function(){var e;return(0,u.__generator)(this,(function(a){switch(a.label){case 0:return"confirm"!==t?[3,2]:(e=T.mud,O(!0),[4,s.post("/delete_msg_l",{token:h.token,data:{mud:e}})]);case 1:a.sent(),j(),l=!0,O(!1),a.label=2;case 2:return[2]}}))}))),a)[e])().finally((function(){I((function(e){return(0,m.default)((0,c.default)({},e),{toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},useDisabled:!1})})),l&&j()}))};return(0,d.useEffect)((function(){h.token&&j()}),[h]),e(d).createElement(E.Container,null,e(d).createElement("div",{className:"msg-layout"},p?null:e(d).createElement("div",{className:"msg-list-header"},["留言者","留言內容","留言文章","留言 / 修改日期","操作項"].map((function(t,a){return e(d).createElement("div",{key:a},t)}))),e(d).createElement("div",{className:"msg-list"},0===k.length?e(d).createElement("div",{className:"no-data"},"-- 無留言 --"):k.map((function(t,a){return p?e(d).createElement("div",{key:a,className:"msg-list-item"},e(d).createElement("div",{className:"top"},e(d).createElement("div",{className:"left"},e(d).createElement("div",null,"留言者"),e(d).createElement("div",null,"留言內容"),e(d).createElement("div",null,"留言文章"),e(d).createElement("div",null,"留言 / 修改日期")),e(d).createElement("div",{className:"right"},e(d).createElement("div",null,t.msgNickName),e(d).createElement("div",null,t.msgContent),e(d).createElement("div",null,t.articleTitle),e(d).createElement("div",null,A(t.createDate)," / ",A(t.modifyDate)))),e(d).createElement("div",{className:"bottom"},e(d).createElement("div",{className:"btn-group"},e(d).createElement("div",{onClick:R.bind(v,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},e(d).createElement("i",{className:"fas fa-eye"})),e(d).createElement("div",{onClick:R.bind(v,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},e(d).createElement("i",{className:"fas fa-pencil"})),e(d).createElement("div",{onClick:R.bind(v,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},e(d).createElement("i",{className:"fas fa-trash-alt"}))))):e(d).createElement("div",{key:a,className:"msg-list-item"},e(d).createElement("div",null,t.msgNickName),e(d).createElement("div",null,t.msgContent),e(d).createElement("div",null,t.articleTitle),e(d).createElement("div",null,A(t.createDate)," / ",A(t.modifyDate)),e(d).createElement("div",{className:"btn-group"},e(d).createElement("div",{onClick:R.bind(v,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},e(d).createElement("i",{className:"fas fa-eye"})),e(d).createElement("div",{onClick:R.bind(v,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},e(d).createElement("i",{className:"fas fa-pencil"})),e(d).createElement("div",{onClick:R.bind(v,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},e(d).createElement("i",{className:"fas fa-trash-alt"}))))}))),e(d).createElement("div",{className:"msg-list-footer"},"總留言數 ",C.length," 則"),e(d).createElement(N.Pagination,w)),e(d).createElement(N.ActionModal,{acionModalTitle:"".concat({DELETE:"刪除",READ:"檢視",EDIT:"編輯"}[L],"留言"),toggleModalStatus:P,confirmEvent:z.bind(v,L,"confirm"),cancelEvent:M?void 0:z.bind(v,L,"cancel")},e(d).createElement("div",{className:"top"},e(d).createElement(N.CustomInput,{label:"留言者",bindVal:T.msgNickName,type:"text",disabled:!0,className:T.msgNickName?"lock":""}),e(d).createElement("div",{className:"text-area-outer"},e(d).createElement(N.CustomTextArea,{label:"留言內容",bindVal:T.msgContent,type:"text",disabled:!0,className:T.msgContent?"lock":""}))),e(d).createElement("div",{className:"bottom"},e(d).createElement("div",{className:"title"},"回覆留言"),e(d).createElement("div",{className:"res-msg-list-outer"},T.resContentList.length>0?e(d).createElement("div",{className:"res-msg-list"},T.resContentList.map((function(t,a){return e(d).createElement("div",{key:a,className:"res-msg-list-item-outer"},e(d).createElement("div",{className:"row g-0"},e(d).createElement("div",{className:M?"col-sm-12":"col-sm-11"},e(d).createElement("div",{className:"res-msg-list-item"},e(d).createElement("div",{className:"res-msg-title"}," ",e(d).createElement("div",null,t.resMsgNickName),e(d).createElement("div",{className:"right-group"},e(d).createElement("div",null,A(t.createDate)))),e(d).createElement("div",null,t.resMsgContent))),M?null:e(d).createElement("div",{className:"col-sm-1"},e(d).createElement("div",{onClick:G.bind(v,t.resMsgID),className:"delete-msg-btn"},e(d).createElement("i",{className:"fas fa-trash-alt"})))))}))):e(d).createElement("div",{className:"no-data"},"-- 無回覆內容 --")))),e(d).createElement(N.ActionModal,{toggleModalStatus:y,confirmEvent:z.bind(v,L,"confirm"),cancelEvent:z.bind(v,L,"cancel")},e(d).createElement("div",{className:"action-modal-body"},e(d).createElement("div",{className:"delete-context"},"確定要刪除 ",T.msgNickName," 此人的留言嗎？"))),e(d).createElement(N.Loading,{loadingStatus:x}))}})),a.register("e4nhi",(function(e,n){t(e.exports,"default",(function(){return m}));var s=a("655lB"),l=a("5UHXD"),r=a("fto12"),i=a("4Fae7"),c=function(){"use strict";function e(){(0,s.default)(this,e)}return(0,l.default)(e,null,[{key:"createParts",value:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=(0,i.default)(t,4),s=n[0],l=n[1],r=n[2],c=n[3];this.setting.totalLength=s.length,this.setting.partPage=r,this.setting.pageTotal=Math.ceil(this.setting.totalLength/this.setting.partPage),this.setting.pageSize=c,l=void 0===l?1:l,this.setting.currentPage=l,this.setting.hasPrev=this.setting.currentPage>1,this.setting.hasNext=this.setting.currentPage<this.setting.totalLength,this.setting.currentPage===this.setting.pageTotal&&(this.setting.hasNext=!1),this.setting.currentPage>this.setting.pageTotal&&(this.setting.currentPage=this.setting.pageTotal);var m=this.setting.currentPage*this.setting.partPage-this.setting.partPage+1,o=this.setting.currentPage*this.setting.partPage,u=s,d=u.map((function(e,t){return t+1>=m&&t+1<=o&&e})).filter((function(e){return!1!==e}));return{pageObj:this.setting,renderItem:d}}}]),e}();(0,r.default)(c,"setting",{totalLength:0,partPage:0,pageTotal:0,currentPage:1,hasPrev:!1,hasNext:!0,pageSize:0});var m=c}))}();