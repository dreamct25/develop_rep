!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,a,n){Object.defineProperty(e,t,{get:a,set:n,enumerable:!0,configurable:!0})}var a=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire35b1;a.register("caVT7",(function(n,s){var r;r=n.exports,Object.defineProperty(r,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",(function(){return p}),(function(e){return p=e}));var i=a("8CHzG"),l=a("fto12"),c=a("75JRK"),m=a("e4tPT"),o=a("4Fae7"),u=a("jvydq"),d=a("diPDO"),g=a("5OXzf"),f=a("e4nhi"),v=a("dR8pc"),N=a("7fGfG"),E=void 0,p=function(){var t,a=(0,d.useContext)(g.NewContext),n=a.$,s=a.Fetch,r=a.getReducer,p=a.rwdStatus,h=r((function(e){return(0,c.default)({},e.AdminLoginReducer)})).authInfo,D=(0,o.default)((0,d.useState)({msgData:[],renderMsgData:[],toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},currentAction:"",useDisabled:!1,paginationObj:{}}),2),b=D[0],k=b.msgData,C=b.renderMsgData,P=b.toggleModalStatus,y=b.toggleDeleteModalStatus,L=b.currentAction,T=b.valGroups,x=b.useDisabled,M=b.paginationObj,S=D[1],I=(0,o.default)((0,d.useState)(!1),2),w=I[0],O=I[1],A={hasPrev:M.hasPrev,hasNext:M.hasNext,currentPage:M.currentPage,pageTotal:M.pageTotal,pageSize:M.pageSize,partPage:M.partPage,postNext:function(e){var t=e.pages,a=e.partPage,n=e.pageSize,s=f.default.createParts(k,t,a,n),r=s.pageObj,i=s.renderItem;S((function(e){return(0,m.default)((0,c.default)({},e),{renderMsgData:i,paginationObj:r})}))}},_=function(e){return(0,o.default)(e.split(" "),1)[0]},j=(t=(0,i.default)(e(u).mark((function t(){return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,s.get("/back_view_all",{token:h.token}).then((function(e){var t=e.data;s.get("/back_msg_l_all",{token:h.token}).then((function(e){var a=n.maps(e.data,(function(e){var a=n.filter(t,(function(t){return t.uuid===e.articleID}));return a.length>0?(0,m.default)((0,c.default)({},e),{articleTitle:a[0].articleTitle}):e})),s=f.default.createParts(a,1,10,10),r=s.pageObj,i=s.renderItem;S((function(e){return(0,m.default)((0,c.default)({},e),{msgData:a,renderMsgData:i,paginationObj:r})})),O(!1)})).catch((function(){return alert("error")}))})).catch((function(){return alert("error")}));case 3:case"end":return e.stop()}}),t)}))),function(){return t.apply(this,arguments)}),R=function(e,t){S("DELETE"===e?function(a){return(0,m.default)((0,c.default)({},a),{currentAction:e,valGroups:t,toggleDeleteModalStatus:!0})}:function(a){return(0,m.default)((0,c.default)({},a),{currentAction:e,valGroups:t,toggleModalStatus:!0,useDisabled:"READ"===e})})},G=function(e){var t=JSON.parse(JSON.stringify(T)),a=n.findIndexOfObj(t.resContentList,(function(t){return t.resMsgID===e}));t.resContentList=t.resContentList.remove(a),S((function(e){return(0,m.default)((0,c.default)({},e),{valGroups:t})}))},z=function(t,a){var r,o=!1;(0,(r={},(0,l.default)(r,t,(0,i.default)(e(u).mark((function r(){var i,l;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==a){e.next=10;break}if("READ"===t){e.next=10;break}return i=n.formatDateTime({formatDate:new Date,formatType:"yyyy-MM-dd HH:mm:ss"}),(l=JSON.parse(JSON.stringify(T))).modifyDate=i,O(!0),e.next=8,s.post("/update_msg_l",{token:h.token,data:l});case 8:o=!0,O(!1);case 10:case"end":return e.stop()}}),r)})))),(0,l.default)(r,"DELETE",(0,i.default)(e(u).mark((function t(){var n;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("confirm"!==a){e.next=8;break}return n=T.mud,O(!0),e.next=5,s.post("/delete_msg_l",{token:h.token,data:{mud:n}});case 5:j(),o=!0,O(!1);case 8:case"end":return e.stop()}}),t)})))),r)[t])().finally((function(){S((function(e){return(0,m.default)((0,c.default)({},e),{toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},useDisabled:!1})})),o&&j()}))};return(0,d.useEffect)((function(){h.token&&j()}),[h]),e(d).createElement(N.Container,null,e(d).createElement("div",{className:"msg-layout"},p?null:e(d).createElement("div",{className:"msg-list-header"},["留言者","留言內容","留言文章","留言 / 修改日期","操作項"].map((function(t,a){return e(d).createElement("div",{key:a},t)}))),e(d).createElement("div",{className:"msg-list"},0===C.length?e(d).createElement("div",{className:"no-data"},"-- 無留言 --"):C.map((function(t,a){return p?e(d).createElement("div",{key:a,className:"msg-list-item"},e(d).createElement("div",{className:"top"},e(d).createElement("div",{className:"left"},e(d).createElement("div",null,"留言者"),e(d).createElement("div",null,"留言內容"),e(d).createElement("div",null,"留言文章"),e(d).createElement("div",null,"留言 / 修改日期")),e(d).createElement("div",{className:"right"},e(d).createElement("div",null,t.msgNickName),e(d).createElement("div",null,t.msgContent),e(d).createElement("div",null,t.articleTitle),e(d).createElement("div",null,_(t.createDate)," / ",_(t.modifyDate)))),e(d).createElement("div",{className:"bottom"},e(d).createElement("div",{className:"btn-group"},e(d).createElement("div",{onClick:R.bind(E,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},e(d).createElement("i",{className:"fas fa-eye"})),e(d).createElement("div",{onClick:R.bind(E,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},e(d).createElement("i",{className:"fas fa-pencil"})),e(d).createElement("div",{onClick:R.bind(E,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},e(d).createElement("i",{className:"fas fa-trash-alt"}))))):e(d).createElement("div",{key:a,className:"msg-list-item"},e(d).createElement("div",null,t.msgNickName),e(d).createElement("div",null,t.msgContent),e(d).createElement("div",null,t.articleTitle),e(d).createElement("div",null,_(t.createDate)," / ",_(t.modifyDate)),e(d).createElement("div",{className:"btn-group"},e(d).createElement("div",{onClick:R.bind(E,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},e(d).createElement("i",{className:"fas fa-eye"})),e(d).createElement("div",{onClick:R.bind(E,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},e(d).createElement("i",{className:"fas fa-pencil"})),e(d).createElement("div",{onClick:R.bind(E,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},e(d).createElement("i",{className:"fas fa-trash-alt"}))))}))),e(d).createElement("div",{className:"msg-list-footer"},"總留言數 ",k.length," 則"),e(d).createElement(v.Pagination,A)),e(d).createElement(v.ActionModal,{acionModalTitle:"".concat({DELETE:"刪除",READ:"檢視",EDIT:"編輯"}[L],"留言"),toggleModalStatus:P,confirmEvent:z.bind(E,L,"confirm"),cancelEvent:x?void 0:z.bind(E,L,"cancel")},e(d).createElement("div",{className:"top"},e(d).createElement(v.CustomInput,{label:"留言者",bindVal:T.msgNickName,type:"text",disabled:!0,className:T.msgNickName?"lock":""}),e(d).createElement("div",{className:"text-area-outer"},e(d).createElement(v.CustomTextArea,{label:"留言內容",bindVal:T.msgContent,type:"text",disabled:!0,className:T.msgContent?"lock":""}))),e(d).createElement("div",{className:"bottom"},e(d).createElement("div",{className:"title"},"回覆留言"),e(d).createElement("div",{className:"res-msg-list-outer"},T.resContentList.length>0?e(d).createElement("div",{className:"res-msg-list"},T.resContentList.map((function(t,a){return e(d).createElement("div",{key:a,className:"res-msg-list-item-outer"},e(d).createElement("div",{className:"row g-0"},e(d).createElement("div",{className:x?"col-sm-12":"col-sm-11"},e(d).createElement("div",{className:"res-msg-list-item"},e(d).createElement("div",{className:"res-msg-title"}," ",e(d).createElement("div",null,t.resMsgNickName),e(d).createElement("div",{className:"right-group"},e(d).createElement("div",null,_(t.createDate)))),e(d).createElement("div",null,t.resMsgContent))),x?null:e(d).createElement("div",{className:"col-sm-1"},e(d).createElement("div",{onClick:G.bind(E,t.resMsgID),className:"delete-msg-btn"},e(d).createElement("i",{className:"fas fa-trash-alt"})))))}))):e(d).createElement("div",{className:"no-data"},"-- 無回覆內容 --")))),e(d).createElement(v.ActionModal,{toggleModalStatus:y,confirmEvent:z.bind(E,L,"confirm"),cancelEvent:z.bind(E,L,"cancel")},e(d).createElement("div",{className:"action-modal-body"},e(d).createElement("div",{className:"delete-context"},"確定要刪除 ",T.msgNickName," 此人的留言嗎？"))),e(d).createElement(v.Loading,{loadingStatus:w}))}})),a.register("e4nhi",(function(e,n){t(e.exports,"default",(function(){return m}));var s=a("655lB"),r=a("5UHXD"),i=a("fto12"),l=a("4Fae7"),c=function(){"use strict";function e(){(0,s.default)(this,e)}return(0,r.default)(e,null,[{key:"createParts",value:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=(0,l.default)(t,4),s=n[0],r=n[1],i=n[2],c=n[3];this.setting.totalLength=s.length,this.setting.partPage=i,this.setting.pageTotal=Math.ceil(this.setting.totalLength/this.setting.partPage),this.setting.pageSize=c,r=void 0===r?1:r,this.setting.currentPage=r,this.setting.hasPrev=this.setting.currentPage>1,this.setting.hasNext=this.setting.currentPage<this.setting.totalLength,this.setting.currentPage===this.setting.pageTotal&&(this.setting.hasNext=!1),this.setting.currentPage>this.setting.pageTotal&&(this.setting.currentPage=this.setting.pageTotal);var m=this.setting.currentPage*this.setting.partPage-this.setting.partPage+1,o=this.setting.currentPage*this.setting.partPage,u=s,d=u.map((function(e,t){return t+1>=m&&t+1<=o&&e})).filter((function(e){return!1!==e}));return{pageObj:this.setting,renderItem:d}}}]),e}();(0,i.default)(c,"setting",{totalLength:0,partPage:0,pageTotal:0,currentPage:1,hasPrev:!1,hasNext:!0,pageSize:0});var m=c}))}();